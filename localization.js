const translations = {
    "en": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Solve puzzles.<br>Adjust telescope.<br>Reveal constellations.",
        "scroll_hint": "SCROLL TO EXPLORE",
        "grid_hint": "TAP TO ALIGN STARS",
        "how_to_play_title": "How to play",
        "story_title": "Story",
        "story_text": "You found an ancient telescope that can reveal forgotten constellations. To look through it, you must adjust the lenses using Light Shards — which you collect by solving logic puzzles.",
        "rules_title": "Rules",
        "rule_1": "The game is played on a 5x5 grid of lights.",
        "rule_2": "Tapping a light toggles it and its neighbors (cross shape).",
        "rule_3": "Turn off all lights to clear the board and collect Light Shards.",
        "gallery_title": "Gallery",
        "cta_title": "Ready to play?",
        "cta_subtitle": "Available on iOS and Android.",
        "nav_download": "Download",
        "play_now": "Play Now",
        "footer_privacy": "Privacy Policy",
        "footer_terms": "Terms of Use",
        "footer_support": "Support",
        "footer_rights": "&copy; 2026 Nikita Ivanov. All rights reserved.",
        "store_apple_small": "Download on the",
        "store_apple_large": "App Store",
        "store_google_small": "GET IT ON",
        "store_google_large": "Google Play"
    },
    "ru": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Решайте загадки.<br>Настройте телескоп.<br>Откройте созвездия.",
        "scroll_hint": "ЛИСТАЙТЕ ВНИЗ",
        "grid_hint": "НАЖМИТЕ, ЧТОБЫ ВЫРОВНЯТЬ ЗВЕЗДЫ",
        "how_to_play_title": "Как играть",
        "story_title": "История",
        "story_text": "Вы нашли древний телескоп, способный открыть забытые созвездия. Чтобы заглянуть в него, нужно настроить линзы с помощью Осколков света, которые вы собираете, решая логические загадки.",
        "rules_title": "Правила",
        "rule_1": "Игра проходит на сетке огней 5x5.",
        "rule_2": "Нажатие на свет переключает его и соседние огни (крестом).",
        "rule_3": "Погасите все огни, чтобы очистить поле и собрать Осколки света.",
        "gallery_title": "Галерея",
        "cta_title": "Готовы играть?",
        "cta_subtitle": "Доступно на iOS и Android.",
        "nav_download": "Скачать",
        "play_now": "Играть сейчас",
        "footer_privacy": "Политика конфиденциальности",
        "footer_terms": "Условия использования",
        "footer_support": "Поддержка",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Все права защищены.",
        "store_apple_small": "Загрузите в",
        "store_apple_large": "App Store",
        "store_google_small": "ДОСТУПНО В",
        "store_google_large": "Google Play"
    },
    "sr": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Rešavajte zagonetke.<br>Podešavajte teleskop.<br>Otkrivajte sazvežđa.",
        "scroll_hint": "SKROLUJTE ZA ISTRAŽIVANJE",
        "grid_hint": "DODIRNITE DA BISTE PORAVNALI ZVEZDE",
        "how_to_play_title": "Kako igrati",
        "story_title": "Priča",
        "story_text": "Pronašli ste drevni teleskop koji može otkriti zaboravljena sazvežđa. Da biste gledali kroz njega, morate podesiti sočiva koristeći Oskolke svetla — koje sakupljate rešavanjem logičkih zagonetki.",
        "rules_title": "Pravila",
        "rule_1": "Igra se na mreži svetala 5x5.",
        "rule_2": "Dodirom na svetlo menjate njegovo stanje i stanje suseda (u obliku krsta).",
        "rule_3": "Ugasite sva svetla da biste očistili tablu i sakupili Oskolke svetla.",
        "gallery_title": "Galerija",
        "cta_title": "Spremni za igru?",
        "cta_subtitle": "Dostupno za iOS i Android.",
        "nav_download": "Preuzmi",
        "play_now": "Igraj odmah",
        "footer_privacy": "Politika privatnosti",
        "footer_terms": "Uslovi korišćenja",
        "footer_support": "Podrška",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Sva prava zadržana.",
        "store_apple_small": "Preuzmite na",
        "store_apple_large": "App Store",
        "store_google_small": "NABAVITE NA",
        "store_google_large": "Google Play"
    },
    "es": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Resuelve acertijos.<br>Ajusta el telescopio.<br>Revela constelaciones.",
        "scroll_hint": "DESPLIZA PARA EXPLORAR",
        "grid_hint": "TOCA PARA ALINEAR ESTRELLAS",
        "how_to_play_title": "Cómo jugar",
        "story_title": "Historia",
        "story_text": "Has encontrado un antiguo telescopio que puede revelar constelaciones olvidadas. Para mirar a través de él, debes ajustar las lentes usando Fragmentos de luz, que obtienes resolviendo acertijos lógicos.",
        "rules_title": "Reglas",
        "rule_1": "El juego se desarrolla en una cuadrícula de luces de 5x5.",
        "rule_2": "Tocar una luz cambia su estado y el de sus vecinas (en forma de cruz).",
        "rule_3": "Apaga todas las luces para limpiar el tablero y recoger Fragmentos de luz.",
        "gallery_title": "Galería",
        "cta_title": "¿Listo para jugar?",
        "cta_subtitle": "Disponible en iOS y Android.",
        "nav_download": "Descargar",
        "play_now": "Jugar ahora",
        "footer_privacy": "Política de privacidad",
        "footer_terms": "Términos de uso",
        "footer_support": "Soporte",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Todos los derechos reservados.",
        "store_apple_small": "Descárgalo en el",
        "store_apple_large": "App Store",
        "store_google_small": "DISPONIBLE EN",
        "store_google_large": "Google Play"
    },
    "pt": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Resolva quebra-cabeças.<br>Ajuste o telescópio.<br>Revele constelações.",
        "scroll_hint": "ROLE PARA EXPLORAR",
        "grid_hint": "TOQUE PARA ALINHAR ESTRELAS",
        "how_to_play_title": "Como jogar",
        "story_title": "História",
        "story_text": "Você encontrou um antigo telescópio capaz de revelar constelações esquecidas. Para olhar através dele, você deve ajustar as lentes usando Fragmentos de luz — que você coleta resolvendo quebra-cabeças lógicos.",
        "rules_title": "Regras",
        "rule_1": "O jogo acontece em uma grade de luzes 5x5.",
        "rule_2": "Tocar em uma luz alterna seu estado e o de suas vizinhas (em forma de cruz).",
        "rule_3": "Apague todas as luzes para limpar o tabuleiro e coletar Fragmentos de luz.",
        "gallery_title": "Galeria",
        "cta_title": "Pronto para jogar?",
        "cta_subtitle": "Disponível para iOS e Android.",
        "nav_download": "Baixar",
        "play_now": "Jogar agora",
        "footer_privacy": "Política de Privacidade",
        "footer_terms": "Termos de Uso",
        "footer_support": "Suporte",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Todos os direitos reservados.",
        "store_apple_small": "Baixar na",
        "store_apple_large": "App Store",
        "store_google_small": "DISPONÍVEL NO",
        "store_google_large": "Google Play"
    },
    "de": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Löse Rätsel.<br>Stelle das Teleskop ein.<br>Enthülle Sternbilder.",
        "scroll_hint": "SCROLLEN ZUM ENTDECKEN",
        "grid_hint": "TIPPEN ZUM AUSRICHTEN",
        "how_to_play_title": "Wie man spielt",
        "story_title": "Geschichte",
        "story_text": "Du hast ein uraltes Teleskop gefunden, das vergessene Sternbilder enthüllen kann. Um hindurchzusehen, musst du die Linsen mit Lichtfragmenten justieren — die du durch das Lösen logischer Rätsel sammelst.",
        "rules_title": "Regeln",
        "rule_1": "Das Spiel wird auf einem 5x5-Lichterraster gespielt.",
        "rule_2": "Ein Tippen auf ein Licht schaltet es und seine Nachbarn um (in Kreuzform).",
        "rule_3": "Schalte alle Lichter aus, um das Brett zu leeren und Lichtfragmente zu sammeln.",
        "gallery_title": "Galerie",
        "cta_title": "Bereit zu spielen?",
        "cta_subtitle": "Verfügbar für iOS und Android.",
        "nav_download": "Herunterladen",
        "play_now": "Jetzt spielen",
        "footer_privacy": "Datenschutzerklärung",
        "footer_terms": "Nutzungsbedingungen",
        "footer_support": "Support",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Alle Rechte vorbehalten.",
        "store_apple_small": "Laden im",
        "store_apple_large": "App Store",
        "store_google_small": "JETZT BEI",
        "store_google_large": "Google Play"
    },
    "fr": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Résolvez des énigmes.<br>Ajustez le télescope.<br>Révélez des constellations.",
        "scroll_hint": "DÉFILEZ POUR EXPLORER",
        "grid_hint": "TOUCHEZ POUR ALIGNER",
        "how_to_play_title": "Comment jouer",
        "story_title": "Histoire",
        "story_text": "Vous avez trouvé un ancien télescope capable de révéler des constellations oubliées. Pour regarder à travers, vous devez ajuster les lentilles en utilisant des Fragments de lumière — que vous collectez en résolvant des énigmes logiques.",
        "rules_title": "Règles",
        "rule_1": "Le jeu se joue sur une grille de lumières 5x5.",
        "rule_2": "Toucher une lumière l'inverse ainsi que ses voisines (en forme de croix).",
        "rule_3": "Éteignez toutes les lumières pour vider le plateau et collecter des Fragments de lumière.",
        "gallery_title": "Galerie",
        "cta_title": "Prêt à jouer ?",
        "cta_subtitle": "Disponible sur iOS et Android.",
        "nav_download": "Télécharger",
        "play_now": "Jouer maintenant",
        "footer_privacy": "Politique de confidentialité",
        "footer_terms": "Conditions d'utilisation",
        "footer_support": "Support",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Tous droits réservés.",
        "store_apple_small": "Télécharger dans",
        "store_apple_large": "l'App Store",
        "store_google_small": "DISPONIBLE SUR",
        "store_google_large": "Google Play"
    },
    "ja": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "パズルを解く。<br>望遠鏡を調整する。<br>星座を解き明かす。",
        "scroll_hint": "スクロールして探索",
        "grid_hint": "タップして星を揃える",
        "how_to_play_title": "遊び方",
        "story_title": "ストーリー",
        "story_text": "あなたは忘れられた星座を映し出す古代の望遠鏡を見つけました。それを覗くには、論理パズルを解いて集めた「光のかけら」を使ってレンズを調整する必要があります。",
        "rules_title": "ルール",
        "rule_1": "ゲームは5x5のライトのグリッドで行われます。",
        "rule_2": "ライトをタップすると、そのライトと隣接するライト（十字形）が切り替わります。",
        "rule_3": "すべてのライトを消してボードをクリアし、「光のかけら」を集めましょう。",
        "gallery_title": "ギャラリー",
        "cta_title": "プレイする準備はいいですか？",
        "cta_subtitle": "iOSとAndroidで利用可能。",
        "nav_download": "ダウンロード",
        "play_now": "今すぐプレイ",
        "footer_privacy": "プライバシーポリシー",
        "footer_terms": "利用規約",
        "footer_support": "サポート",
        "footer_rights": "&copy; 2026 Nikita Ivanov. All rights reserved.",
        "store_apple_small": "ダウンロード",
        "store_apple_large": "App Store",
        "store_google_small": "手に入れよう",
        "store_google_large": "Google Play"
    },
    "ko": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "퍼즐을 푸세요.<br>망원경을 조정하세요.<br>별자리를 밝히세요.",
        "scroll_hint": "스크롤하여 탐험",
        "grid_hint": "탭하여 별 정렬",
        "how_to_play_title": "게임 방법",
        "story_title": "스토리",
        "story_text": "당신은 잊혀진 별자리를 드러낼 수 있는 고대의 망원경을 발견했습니다. 그곳을 들여다보려면 논리 퍼즐을 풀어 모은 '빛의 파편'을 사용하여 렌즈를 조정해야 합니다.",
        "rules_title": "규칙",
        "rule_1": "게임은 5x5 라이트 그리드에서 진행됩니다.",
        "rule_2": "라이트를 탭하면 해당 라이트와 이웃한 라이트(십자 모양)가 전환됩니다.",
        "rule_3": "모든 라이트를 꺼서 보드를 비우고 '빛의 파편'을 수집하세요.",
        "gallery_title": "갤러리",
        "cta_title": "플레이할 준비가 되셨나요?",
        "cta_subtitle": "iOS 및 Android에서 이용 가능.",
        "nav_download": "다운로드",
        "play_now": "지금 플레이",
        "footer_privacy": "개인정보 처리방침",
        "footer_terms": "이용 약관",
        "footer_support": "지원",
        "footer_rights": "&copy; 2026 Nikita Ivanov. All rights reserved.",
        "store_apple_small": "다운로드 하기",
        "store_apple_large": "App Store",
        "store_google_small": "다운로드하기",
        "store_google_large": "Google Play"
    },
    "tr": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Bulmacaları çöz.<br>Teleskobu ayarla.<br>Takımyıldızları keşfet.",
        "scroll_hint": "KEŞFETMEK İÇİN KAYDIR",
        "grid_hint": "HİZALAMAK İÇİN DOKUN",
        "how_to_play_title": "Nasıl Oynanır",
        "story_title": "Hikaye",
        "story_text": "Unutulmuş takımyıldızları ortaya çıkarabilen kadim bir teleskop buldun. İçinden bakmak için, mantık bulmacalarını çözerek topladığın Işık parçalarını kullanarak mercekleri ayarlamalısın.",
        "rules_title": "Kurallar",
        "rule_1": "Oyun 5x5'lik bir ışık ızgarasında oynanır.",
        "rule_2": "Bir ışığa dokunmak, onu ve komşularını (artı şeklinde) değiştirir.",
        "rule_3": "Tahtayı temizlemek ve Işık parçaları toplamak için tüm ışıkları söndür.",
        "gallery_title": "Galeri",
        "cta_title": "Oynamaya hazır mısın?",
        "cta_subtitle": "iOS ve Android'de mevcut.",
        "nav_download": "İndir",
        "play_now": "Şimdi Oyna",
        "footer_privacy": "Gizlilik Politikası",
        "footer_terms": "Kullanım Şartları",
        "footer_support": "Destek",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Tüm hakları saklıdır.",
        "store_apple_small": "İndirin",
        "store_apple_large": "App Store",
        "store_google_small": "EDİNİN",
        "store_google_large": "Google Play"
    },
    "th": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "แก้ปริศนา<br>ปรับกล้องโทรทรรศน์<br>เผยกลุ่มดาว",
        "scroll_hint": "เลื่อนเพื่อสำรวจ",
        "grid_hint": "แตะเพื่อจัดเรียงดาว",
        "how_to_play_title": "วิธีการเล่น",
        "story_title": "เรื่องราว",
        "story_text": "คุณได้พบกล้องโทรทรรศน์โบราณที่สามารถเผยกลุ่มดาวที่ถูกลืม เพื่อที่จะมองผ่านมัน คุณต้องปรับเลนส์โดยใช้ 'เศษแสง' ซึ่งคุณรวบรวมได้จากการแก้ปริศนาตรรกะ",
        "rules_title": "กฎกติกา",
        "rule_1": "เกมเล่นบนตารางไฟขนาด 5x5",
        "rule_2": "การแตะที่ไฟจะเปลี่ยนสถานะของมันและไฟข้างเคียง (รูปกากบาท)",
        "rule_3": "ดับไฟทั้งหมดเพื่อเคลียร์กระดานและรวบรวม 'เศษแสง'",
        "gallery_title": "แกลเลอรี",
        "cta_title": "พร้อมเล่นหรือยัง?",
        "cta_subtitle": "พร้อมใช้งานบน iOS และ Android",
        "nav_download": "ดาวน์โหลด",
        "play_now": "เล่นเลย",
        "footer_privacy": "นโยบายความเป็นส่วนตัว",
        "footer_terms": "เงื่อนไขการใช้งาน",
        "footer_support": "สนับสนุน",
        "footer_rights": "&copy; 2026 Nikita Ivanov. สงวนลิขสิทธิ์",
        "store_apple_small": "ดาวน์โหลดได้ที่",
        "store_apple_large": "App Store",
        "store_google_small": "ดาวน์โหลดได้จาก",
        "store_google_large": "Google Play"
    },
    "id": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "Pecahkan teka-teki.<br>Sesuaikan teleskop.<br>Ungkap rasi bintang.",
        "scroll_hint": "GULIR UNTUK MENJELAJAH",
        "grid_hint": "KETUK UNTUK MENYELARASKAN",
        "how_to_play_title": "Cara Bermain",
        "story_title": "Cerita",
        "story_text": "Anda menemukan teleskop kuno yang dapat mengungkap rasi bintang yang terlupakan. Untuk melihat melaluinya, Anda harus menyesuaikan lensa menggunakan Pecahan cahaya — yang Anda kumpulkan dengan memecahkan teka-teki logika.",
        "rules_title": "Aturan",
        "rule_1": "Permainan dimainkan di grid cahaya 5x5.",
        "rule_2": "Mengetuk cahaya akan mengubah statusnya dan tetangganya (bentuk tambah).",
        "rule_3": "Matikan semua cahaya untuk membersihkan papan dan mengumpulkan Pecahan cahaya.",
        "gallery_title": "Galeri",
        "cta_title": "Siap bermain?",
        "cta_subtitle": "Tersedia di iOS dan Android.",
        "nav_download": "Unduh",
        "play_now": "Main Sekarang",
        "footer_privacy": "Kebijakan Privasi",
        "footer_terms": "Syarat Penggunaan",
        "footer_support": "Dukungan",
        "footer_rights": "&copy; 2026 Nikita Ivanov. Hak cipta dilindungi.",
        "store_apple_small": "Unduh di",
        "store_apple_large": "App Store",
        "store_google_small": "TEMUKAN DI",
        "store_google_large": "Google Play"
    },
    "zh": {
        "hero_title": "ASTRONIGMA",
        "hero_subtitle": "解开谜题<br>调整望远镜<br>揭示星座",
        "scroll_hint": "滑动探索",
        "grid_hint": "点击对齐星辰",
        "how_to_play_title": "怎么玩",
        "story_title": "故事",
        "story_text": "你发现了一架能够揭示被遗忘星座的古老望远镜。为了通过它观察，你需要使用光之碎片来调整镜片——这些碎片是你通过解开逻辑谜题收集到的。",
        "rules_title": "规则",
        "rule_1": "游戏在 5x5 的灯光网格上进行。",
        "rule_2": "点击灯光会切换它及其邻居（十字形）的状态。",
        "rule_3": "熄灭所有灯光以清除棋盘并收集光之碎片。",
        "gallery_title": "画廊",
        "cta_title": "准备好开始了吗？",
        "cta_subtitle": "可在 iOS 和 Android 上下载。",
        "nav_download": "下载",
        "play_now": "立即游戏",
        "footer_privacy": "隐私政策",
        "footer_terms": "使用条款",
        "footer_support": "支持",
        "footer_rights": "&copy; 2026 Nikita Ivanov. 保留所有权利。",
        "store_apple_small": "下载",
        "store_apple_large": "App Store",
        "store_google_small": "即刻下载",
        "store_google_large": "Google Play"
    }
};

class LocalizationManager {
    constructor() {
        this.currentLang = 'en';
        this.supportedLangs = ['en', 'ru', 'sr', 'es', 'pt', 'de', 'fr', 'ja', 'ko', 'tr', 'th', 'id', 'zh'];

        this.init();
    }

    init() {
        this.currentLang = this.determineLanguage();
        this.updateContent();
        this.createLanguageSwitcher();
    }

    determineLanguage() {
        // 1. Check URL parameter (highest priority)
        const urlParams = new URLSearchParams(window.location.search);
        const urlLang = urlParams.get('lang');
        if (urlLang && this.supportedLangs.includes(urlLang)) {
            localStorage.setItem('astronigma_lang', urlLang);
            return urlLang;
        }

        // 2. Check saved preference
        const savedLang = localStorage.getItem('astronigma_lang');
        if (savedLang && this.supportedLangs.includes(savedLang)) {
            return savedLang;
        }

        // 3. Check browser system language
        const systemLang = (navigator.language || navigator.userLanguage || 'en').toLowerCase();

        // Map common codes to our internal codes
        if (systemLang === 'sr' || systemLang.startsWith('sr-')) return 'sr';
        if (systemLang === 'ru' || systemLang === 'ru-ru') return 'ru';
        if (systemLang === 'es' || systemLang.startsWith('es-')) return 'es';
        if (systemLang === 'pt' || systemLang.startsWith('pt-')) return 'pt';
        if (systemLang === 'de' || systemLang.startsWith('de-')) return 'de';
        if (systemLang === 'fr' || systemLang.startsWith('fr-')) return 'fr';
        if (systemLang === 'ja' || systemLang.startsWith('ja-')) return 'ja';
        if (systemLang === 'ko' || systemLang.startsWith('ko-')) return 'ko';
        if (systemLang === 'tr' || systemLang.startsWith('tr-')) return 'tr';
        if (systemLang === 'th' || systemLang.startsWith('th-')) return 'th';
        if (systemLang === 'id' || systemLang.startsWith('id-')) return 'id';
        if (systemLang === 'zh' || systemLang.startsWith('zh-')) return 'zh';

        // 4. Default
        return 'en';
    }

    updateContent() {
        // Update html lang attribute
        document.documentElement.lang = this.currentLang;

        // Update all elements with data-i18n
        const elements = document.querySelectorAll('[data-i18n]');
        elements.forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[this.currentLang] && translations[this.currentLang][key]) {
                if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                    element.placeholder = translations[this.currentLang][key];
                } else {
                    element.innerHTML = translations[this.currentLang][key];
                }
            }
        });

        // Update language switcher active state
        const select = document.getElementById('lang-select');
        if (select) {
            select.value = this.currentLang;
        }

        // Update Gallery
        this.updateGallery();
    }

    updateGallery() {
        const track = document.getElementById('gallery-track');
        if (!track) return;

        track.innerHTML = '';

        // We have 5 screenshots per language
        for (let i = 1; i <= 5; i++) {
            const item = document.createElement('div');
            item.className = 'gallery-item glass-card';

            // Container for image with placeholder/loading state
            const imgContainer = document.createElement('div');
            imgContainer.className = 'image-placeholder';
            imgContainer.style.background = 'none'; // Overwrite CSS placeholder
            imgContainer.style.padding = '0';

            const img = document.createElement('img');
            const thumbSrc = `assets/screenshots/thumbs/${this.currentLang}_${i}.png`;
            const fullSrc = `assets/screenshots/${this.currentLang}_${i}.png`;

            img.src = thumbSrc;
            img.alt = `Screenshot ${i}`;
            // img.loading = 'lazy'; // Removed to fix Safari horizontal scroll issue

            // Lightbox trigger
            img.addEventListener('click', () => {
                if (window.openLightbox) window.openLightbox(fullSrc);
            });

            item.appendChild(img);
            track.appendChild(item);
        }
    }

    setLanguage(lang) {
        if (this.supportedLangs.includes(lang)) {
            this.currentLang = lang;
            localStorage.setItem('astronigma_lang', lang);

            // Update URL without reloading if possible, or just reload to be safe and clean
            const url = new URL(window.location);
            url.searchParams.set('lang', lang);
            window.history.pushState({}, '', url);

            this.updateContent();
        }
    }

    createLanguageSwitcher() {
        // Find the place to insert the switcher (e.g., inside nav)
        const navLinks = document.querySelector('.nav-links');
        if (!navLinks) return;

        // Check if already exists
        if (document.getElementById('lang-select')) return;

        const li = document.createElement('li');
        const select = document.createElement('select');
        select.id = 'lang-select';
        select.className = 'nav-lang-select';

        const options = [
            { code: 'en', label: 'English' },
            { code: 'ru', label: 'Русский' },
            { code: 'sr', label: 'Srpski' },
            { code: 'es', label: 'Español' },
            { code: 'pt', label: 'Português' },
            { code: 'de', label: 'Deutsch' },
            { code: 'fr', label: 'Français' },
            { code: 'ja', label: '日本語' },
            { code: 'ko', label: '한국어' },
            { code: 'tr', label: 'Türkçe' },
            { code: 'th', label: 'ไทย' },
            { code: 'id', label: 'Bahasa Indonesia' },
            { code: 'zh', label: '简体中文' }
        ];

        options.forEach(opt => {
            const option = document.createElement('option');
            option.value = opt.code;
            option.textContent = opt.label;
            if (opt.code === this.currentLang) option.selected = true;
            select.appendChild(option);
        });

        select.addEventListener('change', (e) => this.setLanguage(e.target.value));

        li.appendChild(select);
        // Insert before the download button (last item)
        navLinks.insertBefore(li, navLinks.lastElementChild);
    }
}

// Initialize Localization
document.addEventListener('DOMContentLoaded', () => {
    window.localizationManager = new LocalizationManager();
});
